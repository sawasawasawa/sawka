<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>sawka.pro</title>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <style>circle {
        fill:black;
        stroke:black;
        opacity:0.5;}</style>
</head>
<body>
<svg></svg>
<script>
    var svg = d3.select("svg");
    var _width = window.innerWidth;
    var _height = window.innerHeight;
    svg.attr('width', _width)
            .attr('height', _height);
    var g = svg.append("g");
    var _dataset = [];

    var _animationLength=5000;
    var _counter = 500;
    var _singleAnimation = _animationLength/_counter;

    columns = [];
    for (i=0; i<_width;i+=10){
        columns.push([i])
    }
    console.log(columns.length);
    for (i=0; i<_height;i+=10){
        for (j=0;j<columns.length;j+=1){
            _dataset.push([i, 10*j])
        }
    }
    console.log(_dataset.length/columns.length);
    // while (_counter){
    //     _dataset.push(_counter);
    //     _counter --;
    // }
    console.log('elo');
    g.selectAll('rect').data(_dataset)
            .enter()
            .append('rect')
            .each(function (d){

                d3.select(this)
                        .attr("id", d[0]+"_"+d[1])
                        .attr("x", d[1])
                        .attr("y", d[0])
                        .attr("width", 10)
                        .attr("height", 10)
                        .attr('fill', 'blue')
                        .style('opacity', 0.4)
                        .transition().delay(2000+d[0]*10-Math.round(Math.random()*2000)).duration(1050)
                        .attr('fill', 'orange')
                        .style('opacity', 0.7)
                // .transition().delay(2*d[0]*10-Math.round(Math.random()*500)).duration(50)
                // .attr('fill', 'blue')
                // .style('opacity', 0.3)
            })
    ;
    d3.selectAll("rect")
            .on("mouseenter", function() {
                console.log('mousenter on ', "#" + name);
                d3.select(this)
                        .transition().delay(0).duration(_singleAnimation)
                        .style('opacity', 0.1)
                        .transition().delay(2000).duration(2000)
                        .style('fill','orange')
                        .style('opacity', 0.7)
                        .transition().delay(4000).duration(2000)
                        .attr('fill', 'blue')
                        .style('opacity', 0.7)
                ;
            });
    d3.select('fullwidth')
            .style('opacity', 0)
            .transition().delay(0).duration(_singleAnimation)
            .style('opacity', 0.1)
            .transition().delay(5000).duration(2000)
            .style('opacity', 0.9)
    ;
</script>
</body>
</html>